

-- ##################################################################
IF NOT EXISTS(SELECT * FROM CURRENCIES WHERE CODE='EUR')
BEGIN
	exec catInsertCurrency 'EUR', 'EURO'
END

IF NOT EXISTS(SELECT * FROM COUNTRIES WHERE Code='FRA')
BEGIN
	DECLARE @IDEURO INT
	DECLARE @RANK INT
	SELECT @IdEuro = Id FROM CURRENCIES WHERE CODE='EUR'
	SELECT @RANK = MAX(RANK)+1 FROM COUNTRIES
	
	exec catInsertCountry 'FRA', 'FRANCE',NULL, @IdEuro,NULL,@RANK

END

IF NOT EXISTS(SELECT ID FROM OWNERS WHERE CODE='OWNER1')
BEGIN

	DECLARE @RANKOWNER INT
	SELECT @RANKOWNER = MAX(RANK)+1 FROM OWNERS
	
	exec catInsertOwner 'OWNER1', 'OWNER 1',1,@RANKOWNER

END


IF NOT EXISTS(SELECT ID FROM PROGRAMS WHERE CODE='PROGRAM1')
BEGIN
	
	DECLARE @RANKPROGRAM INT
	SELECT @RANKPROGRAM = MAX(RANK)+1 FROM PROGRAMS
	DECLARE @IDOWNER1 INT
	SELECT @IDOWNER1  = ID FROM OWNERS WHERE CODE='OWNER1'

	exec catInsertProgram @IDOWNER1, 'PROGRAM1', 'PROGRAM 1',1,@RANKPROGRAM

END

IF NOT EXISTS(SELECT ID FROM PROJECT_TYPES WHERE TYPE='PROJTYPE1')
BEGIN

DECLARE @RANKPROJTYPE INT
SELECT @RANKPROJTYPE = MAX(RANK)+1 FROM PROJECT_TYPES

exec catInsertProjectType 'PROJTYPE1', @RANKPROJTYPE

END

IF NOT EXISTS(SELECT ID FROM PROJECTS WHERE CODE='C040021')
BEGIN

DECLARE @IDPROGRAM1 INT
DECLARE @IDPROJTYPE1 INT

SELECT @IDPROGRAM1 = ID FROM PROGRAMS WHERE CODE = 'PROGRAM1'
SELECT @IDPROJTYPE1 = ID FROM PROJECT_TYPES WHERE TYPE = 'PROJTYPE1'

exec catInsertProject 'C040021', 'COROSIVE PROJ 40021', @IDPROGRAM1, @IDPROJTYPE1, 1

END

IF NOT EXISTS(SELECT ID FROM INERGY_LOCATIONS WHERE CODE='ILF')
BEGIN
	DECLARE @IDCOUNTRY INT
	SELECT @IDCOUNTRY = ID FROM COUNTRIES WHERE CODE='FRA'
	DECLARE @ILRANK INT
	SELECT @ILRANK = MAX(RANK)+1 FROM INERGY_LOCATIONS

	exec catInsertInergyLocation @IDCOUNTRY, 'ILF','INERGY LOC FRANCE', @ILRANK

END


IF NOT EXISTS (SELECT ID FROM DEPARTMENTS WHERE NAME='Department1')
BEGIN
	DECLARE @RankDEPARTMENT int
	SELECT @RankDEPARTMENT = MAX(RANK)+1 FROM DEPARTMENTS
	exec catInsertDepartment 1, 'Department1', @RankDEPARTMENT
END

IF NOT EXISTS(SELECT ID FROM COST_CENTERS WHERE CODE='A61050')
BEGIN
	DECLARE @IDINERGYLOCATION INT
	SELECT @IDINERGYLOCATION = ID FROM INERGY_LOCATIONS WHERE CODE='ILF'
	DECLARE @IDDEPART INT
	SELECT @IDDEPART = ID FROM DEPARTMENTS WHERE NAME='Department1'

	exec catInsertCostCenter @IDINERGYLOCATION, @IDDEPART,1,'A61050', 'COSTCENTER LAVALE'
END

--INSERT WORK PACKAGE CODE = 704 FOR PROJECT CODE=C040021

DECLARE @PROJID INT
SELECT @PROJID = ID FROM PROJECTS WHERE CODE='C040021'

IF NOT EXISTS(SELECT ID FROM WORK_PACKAGES WHERE IDPHASE=8 AND  IDPROJECT=@PROJID)
BEGIN
	DECLARE @RANKWP INT
	SELECT @RANKWP = MAX(RANK)+1 FROM WORK_PACKAGES
	EXEC catInsertWorkPackage 8, '704', 'WP SERIAL LIFE', @RANKWP, @PROJID, 1, 200910, 200912,1
END

DECLARE @IDCOUNTRYGL INT
SELECT @IDCOUNTRYGL = ID FROM COUNTRIES WHERE CODE='FRA'



IF NOT EXISTS(SELECT ID FROM GL_ACCOUNTS WHERE ACCOUNT='43A71050' AND IDCOUNTRY=@IDCOUNTRYGL)
BEGIN
	EXEC catInsertGlAccount @IDCOUNTRYGL, '43A71050', 'FRAHOURS43A', 6

	EXEC catInsertGlAccount @IDCOUNTRYGL, '43A71056', 'FRASALES43A', 7
	EXEC catInsertGlAccount @IDCOUNTRYGL, '43A71051', 'FRATE43A', 1
	EXEC catInsertGlAccount @IDCOUNTRYGL, '43A71052', 'FRAPROTOPARTS43A', 2
	EXEC catInsertGlAccount @IDCOUNTRYGL, '43A71053', 'FRATOOLING43A', 3
	EXEC catInsertGlAccount @IDCOUNTRYGL, '43A71054', 'FRATRIALS43A', 4
	EXEC catInsertGlAccount @IDCOUNTRYGL, '43A71055', 'FRAOTHER43A', 5
END
